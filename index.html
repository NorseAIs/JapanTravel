<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Japan Trip Planner</title>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Leaflet CSS & JS (must be before main.js) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>


  <!-- JP fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;700&family=Noto+Serif+JP:wght@500;700&display=swap" rel="stylesheet">

  <!-- LZ-String for Share links -->
  <script src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js"></script>

  <!-- Basic SEO -->
  <meta name="description" content="Plan and share a Japan itinerary with map, budget, checklists, and curated recommendations." />
  <meta name="theme-color" content="#0b0f1a" />

  <!-- Social (optional image can be added later) -->
  <meta property="og:title" content="Japan Trip Planner" />
  <meta property="og:description" content="Build a shareable Japan itinerary with map, budget, checklists, and recommendations." />
  <meta property="og:type" content="website" />
  <!-- <meta property="og:image" content="https://your-username.github.io/your-repo/og-image.jpg" /> -->
  <!-- <meta property="og:url" content="https://your-username.github.io/your-repo/" /> -->

  <link rel="stylesheet" href="styles.css" />
</head>
<body class="jp-max" data-readonly="0">
   <a class="skip-link" href="#main">Skip to main content</a>
  <div class="app">
    <header role="banner">
      <div id="ariaStatus" aria-live="polite" class="visually-hidden"></div>
      <div id="publicBanner" style="display:none" class="card" >
  <div class="inner" style="padding:8px 12px;">
    <strong>Read-only preview.</strong> You can browse and print this plan. To edit, open the normal link (no <code>?public=1</code>).
  </div>
</div>
      <div class="title">
        <span class="hinomaru"></span>
        <span class="mincho">Êó•Êú¨ÊóÖ</span>
        <span class="divider"></span>
        <span>Japan Trip Planner ¬∑ <span id="yearSpan"></span></span>
      </div>

      <div class="header-center">
        <div id="countdown" class="countdown-widget">Set a departure date ‚Üí</div>
      </div>

      <div class="header-controls">
  <div class="pill">
    <span>Âá∫Áô∫Êó•</span>
    <input id="departInput" type="date" />
  </div>

  <button class="btn" id="shareBtn">Share</button>
  <button class="btn" id="templateBtn">Templates</button>
  <button class="btn" id="printBtn">Print / PDF</button>
  <button class="btn" id="showOnboard">Show tips</button>
  <button class="btn" id="feedbackBtn">Feedback</button>

  <!-- Move this block to be the LAST item -->
  <div class="dropdown">
  <button class="btn dropdown-toggle">More ‚ñæ</button>
  <div class="dropdown-menu">
    <button type="button" class="menu-item" id="exportBtn">Export JSON</button>
    <button type="button" class="menu-item" id="importBtn">Import JSON</button>
    <input id="importFile" type="file" accept="application/json" hidden>
  </div>
</div>
</div>
    </header>

    <aside>
      <div class="sidebar">
        <div class="section">
          <h3>üó∫Ô∏è Route</h3>
          <div class="route" id="routeList"></div>
        </div>
      </div>
    </aside>

    <main id="main" role="main">
      <!-- Templates panel -->
<section id="templatesPanel" class="templates hide" aria-hidden="true">
  <h3>Starter Plans</h3>
  <div class="tpl-row">
    <button class="btn tpl" data-days="7">Apply 7-day plan</button>
    <button class="btn tpl" data-days="14">Apply 14-day plan</button>
    <button class="btn tpl" data-days="21">Apply 21-day plan</button>
  </div>
  <p class="muted">
    Uses <code>recommended.json</code> if present to suggest key POIs.  
    Your Notes and Budget will be kept.
  </p>
  <div class="tpl-actions">
    <button class="btn" id="templatesClose">Close</button>
  </div>
</section>
      <div class="content">
        <div class="card">
          <h3>‚õ© Map & Route</h3>
          <div class="inner mapWrap">
            <div id="leafletMap"></div>
            <div class="legend">Leaflet + OpenStreetMap ‚Ä¢ Click a city/itinerary item to focus</div>
          </div>
        </div>

        <!-- Onboarding (shown once, controlled by main.js) -->
        <div class="card" id="onboardCard" style="display:none; margin-top:12px;">
          <h3>‚ú® Get started fast</h3>
          <div class="inner">
            <p>Pick a starter plan or keep building your own.</p>
            <div style="display:flex; gap:8px; flex-wrap:wrap">
              <button class="btn ok" id="tplFirstTimer">7-Day First-Timer</button>
              <button class="btn ok" id="tplAnimeTour">Anime Tour (Tokyo)</button>
              <button class="btn" id="onboardDismiss">Dismiss</button>
            </div>
          </div>
        </div>

        <div class="card" id="cityCard">
          <h3>üìù City Details</h3>
          <div class="inner">
            <div class="grid two">
              <div><label>City</label><input id="cityName" /></div>
              <div><label>Dates (start ‚Üí end)</label><input id="cityDates" placeholder="2026-10-05 ‚Üí 2026-10-08" /></div>
              <div><label>Accommodation</label><input id="cityStay" placeholder="Hotel / Ryokan + booking ref" /></div>
              <div><label>Transport</label><input id="cityTransport" placeholder="e.g. Nozomi 31, 10:09 Tokyo ‚Üí Nagoya" /></div>
              <div class="grid two span2">
                <div><label>Plan / Must-do</label><textarea id="cityPlan" placeholder="Top sights, food spots, events"></textarea></div>
                <div><label>Notes</label><textarea id="cityNotes" placeholder="Anything else"></textarea></div>
              </div>
            </div>
          </div>
          <div class="foot">
            <button class="btn ok" id="saveCity">Save city</button>
            <button class="btn warn" id="deleteCity">Delete city</button>
            <span class="hint" id="saveHint"></span>
          </div>
        </div>
      </div>

      <div class="tabs" id="tabs" role="navigation" aria-label="Primary">
  <!-- NEW: Tips first + set as default active -->
  <button class="tab active" data-tab="tips">üí° Tips & Advice</button>
  <button class="tab" data-tab="budget">üí¥ Budget</button>
  <button class="tab" data-tab="checklist">üéí Packing & To-do</button>
  <button class="tab" data-tab="shared">Notes</button>
  <button class="tab" data-tab="itinerary">üóìÔ∏è Itinerary</button>
  <button class="tab" data-tab="recommended">Recommended</button>
</div>

<!-- NEW: Tips & Advice -->
<div class="tabPanel" id="tab-tips">
  <div class="inner tips">
    <!-- Compact Month Grid -->
<div id="monthsView" class="month-grid" aria-label="Monthly overview"></div>
    <h4 style="margin-top:12px">When to Visit ‚Äî at a glance</h4>

    <div class="when-toolbar">
      <label for="whenCitySel">Region:</label>
      <select id="whenCitySel">
        <option value="japan">Japan (overall)</option>
        <option value="tokyo">Tokyo (Kant≈ç)</option>
        <option value="kansai">Kyoto / Osaka (Kansai)</option>
        <option value="hokkaido">Hokkaid≈ç (Sapporo)</option>
        <option value="okinawa">Okinawa (Naha)</option>
      </select>
      <span class="when-legend">
        <span class="legend-label">Crowds:</span>
        <span class="pill crowd low">Low</span>
        <span class="pill crowd med">Med</span>
        <span class="pill crowd high">High</span>
        <span class="sep"></span>
        <span class="legend-label">Prices:</span>
        <span class="price-legend">
          <span class="dollar on" aria-hidden="true">$</span>
          <span class="dollar off" aria-hidden="true">$</span>
          <span class="dollar off" aria-hidden="true">$</span>
          <span class="dollar off" aria-hidden="true">$</span>
        </span>
      </span>
    </div>

    <div id="whenGrid" class="when-grid"></div>

    <h4>Transport tips</h4>
    <ul class="bullet">
      <li><strong>IC cards</strong> (Suica/PASMO/ICOCA) for local trains, metro, konbini.</li>
      <li><strong>JR Pass?</strong> Worth it only if you‚Äôre doing multiple long shinkansen hops in ~7‚Äì14 days.</li>
      <li><strong>Seat reservations:</strong> consider for weekends/holidays and busy routes.</li>
    </ul>

    <h4>Etiquette & practical</h4>
    <ul class="bullet">
      <li>No eating on most local trains; quiet voices; queue lines on platforms.</li>
      <li>Cash is still common at small shops; ATMs at 7-Eleven work with foreign cards.</li>
      <li>Learn a few: „Åì„Çì„Å´„Å°„ÅØ (hello), „ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô (thank you), „Åô„Åø„Åæ„Åõ„Çì (excuse me).</li>
    </ul>
  </div>
</div>


        <!-- Budget -->
        <div class="tabPanel" id="tab-budget">
          <div class="actions">
            <select id="budgetCity"></select>
            <input id="bItem" placeholder="Item (e.g., Hotel, JR, Food)" aria-label="Item (e.g., Hotel, JR, Food)" />
            <input id="bCost" type="number" placeholder="Cost (JPY)" aria-label="Cost (JPY)" />
            <input id="bPeople" type="number" placeholder="People" value="1" aria-label="People"/>
            <button class="btn primary" id="addBudget">Add</button>
            <button class="btn ok" id="saveBudget" style="display:none">Save</button>
            <button class="btn" id="cancelEdit" style="display:none">Cancel</button>
          </div>
          <table id="budgetTable" class="table-clean">
            <thead><tr>
              <th style="width:18%">City</th>
              <th>Item</th>
              <th class="num">Cost (JPY)</th>
              <th class="num">People</th>
              <th class="num">Per person</th>
              <th style="width:140px"></th>
            </tr></thead>
            <tbody></tbody>
            <tfoot><tr>
              <td colspan="2" class="right">Total</td>
              <td id="totalCost" class="num">0</td>
              <td></td>
              <td id="totalPer" class="num">0</td>
              <td></td>
            </tr></tfoot>
          </table>
        </div>

        <!-- Checklist -->
        <div class="tabPanel" id="tab-checklist" style="display:none">
          <div class="actions">
            <input id="cItem" placeholder="New item" />
            <button class="btn primary" id="addCheck">Add</button>
            <button class="btn" id="clearChecked">Clear all</button>
          </div>
          <ul id="checklist" class="list"></ul>
        </div>

        <!-- Shared (multi-note) -->
        <div class="tabPanel" id="tab-shared" style="display:none">
          <div class="actions">
            <input id="noteTitle" placeholder="Title (e.g., Kyoto food spots)" />
            <input id="noteTag" placeholder="Tag (optional)" />
          </div>
          <textarea id="noteBody" class="bigarea" placeholder="Write your note..."></textarea>
          <div class="foot">
            <button class="btn primary" id="addNoteBtn">Add note</button>
            <button class="btn ok" id="saveNoteBtn" style="display:none">Save</button>
            <button class="btn" id="cancelNoteBtn" style="display:none">Cancel</button>
          </div>
          <div id="notesList" class="notes-grid"></div>
        </div>

        <!-- Itinerary -->
        <div class="tabPanel" id="tab-itinerary" style="display:none">
          <div class="actions it-actions">
            <input type="date" id="itDate" />
            <input type="time" id="itTime" placeholder="Time" />
            <select id="itType">
              <option value="city">City</option>
              <option value="poi">POI</option>
              <option value="note">Note</option>
            </select>
            <select id="itCity"></select>
            <input type="text" id="itTitle" placeholder="Title (for POI/Note)" />
            <input type="number" step="any" id="itLat" placeholder="Lat (POI optional)" />
            <input type="number" step="any" id="itLon" placeholder="Lon (POI optional)" />
            <button id="addItinerary" class="btn ok">Add</button>
          </div>
          <div class="hint">Tip: Click a date header to focus the map. Drag items to reorder within that day.</div>
          <div id="itineraryList"></div>
        </div>

        <!-- Recommended -->
        <div class="tabPanel" id="tab-recommended" style="display:none">
          <div class="actions">
            <select id="recCityFilter"><option value="">All cities</option></select>
            <select id="recCategoryFilter">
              <option value="">All categories</option>
              <option value="Destination">Destination</option>
              <option value="Food">Food</option>
              <option value="Culture">Culture</option>
              <option value="Shopping">Shopping</option>
            </select>
            <button class="btn ok" id="addAllRec">Add all to day</button>
          </div>
          <div id="recommendedList" class="notes-grid"></div>
        </div>

      </div>
    </main>
  </div>

  <script src="main.js"></script>
</body>
</html>
