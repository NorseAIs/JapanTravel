<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Japan Trip Planner</title>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js"></script>

  <!-- JP fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;700&family=Noto+Serif+JP:wght@500;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css" />
</head>
<body class="jp-max">
  <div class="app">
    <header>
      <div class="title">
        <span class="hinomaru"></span>
        <span class="mincho">Êó•Êú¨ÊóÖ</span>
        <span class="divider"></span>
        <span>Japan Trip Planner ¬∑ <span id="yearSpan"></span></span>
      </div>

      <div class="header-center">
        <div id="countdown" class="countdown-widget">Set a departure date ‚Üí</div>
      </div>

      <div class="right">
        <div class="pill">
          <span>Âá∫Áô∫Êó•</span>
          <input id="departInput" type="date" />
        </div>
        <!-- removed theme picker for single-theme build -->
        <button class="btn" id="exportBtn">Export JSON</button>
        <label class="btn" for="importFile">Import JSON
          <input id="importFile" type="file" accept="application/json" hidden>
        </label>
      </div>
      <button class="btn" id="shareBtn">Share</button>

    </header>

    <aside>
      <div class="sidebar">
        <div class="section">
          <h3>üó∫Ô∏è Route</h3>
          <div class="route" id="routeList"></div>
        </div>

      </div>
    </aside>

    <main>
      <div class="content">
        <div class="card">
          <h3>‚õ© Map & Route</h3>
          <div class="inner mapWrap">
            <div id="leafletMap"></div>
            <div class="legend">Leaflet + OpenStreetMap ‚Ä¢ Click a city/itinerary item to focus</div>
          </div>
        </div>

        <div class="card" id="cityCard">
          <h3>üìù City Details</h3>
          <div class="inner">
            <div class="grid two">
              <div><label>City</label><input id="cityName" /></div>
              <div><label>Dates (start ‚Üí end)</label><input id="cityDates" placeholder="2026-10-05 ‚Üí 2026-10-08" /></div>
              <div><label>Accommodation</label><input id="cityStay" placeholder="Hotel / Ryokan + booking ref" /></div>
              <div><label>Transport</label><input id="cityTransport" placeholder="e.g. Nozomi 31, 10:09 Tokyo ‚Üí Nagoya" /></div>
              <div class="grid two span2">
                <div><label>Plan / Must-do</label><textarea id="cityPlan" placeholder="Top sights, food spots, events"></textarea></div>
                <div><label>Notes</label><textarea id="cityNotes" placeholder="Anything else"></textarea></div>
              </div>
            </div>
          </div>
          <div class="foot">
            <button class="btn ok" id="saveCity">Save city</button>
            <button class="btn warn" id="deleteCity">Delete city</button>
            <span class="hint" id="saveHint"></span>
          </div>
        </div>
      </div>

      <div class="card mtop">
        <div class="tabs">
          <button class="tab" data-tab="budget">üí¥ Budget</button>
          <button class="tab" data-tab="checklist">üéí Packing & To-do</button>
          <button class="tab" data-tab="shared">Notes</button>
          <button class="tab" data-tab="itinerary">üóìÔ∏è Itinerary</button>
          <button class="tab" data-tab="recommended">Recommended</button>
        </div>

        <!-- Budget -->
        <div class="tabPanel" id="tab-budget">
          <div class="actions">
            <select id="budgetCity"></select>
            <input id="bItem" placeholder="Item (e.g., Hotel, JR, Food)" />
            <input id="bCost" type="number" placeholder="Cost (JPY)" />
            <input id="bPeople" type="number" placeholder="People" value="1"/>
            <button class="btn primary" id="addBudget">Add</button>
            <button class="btn ok" id="saveBudget" style="display:none">Save</button>
            <button class="btn" id="cancelEdit" style="display:none">Cancel</button>
          </div>
          <table id="budgetTable" class="table-clean">
            <thead><tr>
              <th style="width:18%">City</th>
              <th>Item</th>
              <th class="num">Cost (JPY)</th>
              <th class="num">People</th>
              <th class="num">Per person</th>
              <th style="width:140px"></th>
            </tr></thead>
            <tbody></tbody>
            <tfoot><tr>
              <td colspan="2" class="right">Total</td>
              <td id="totalCost" class="num">0</td>
              <td></td>
              <td id="totalPer" class="num">0</td>
              <td></td>
            </tr></tfoot>
          </table>
        </div>

        <!-- Checklist -->
        <div class="tabPanel" id="tab-checklist" style="display:none">
          <div class="actions">
            <input id="cItem" placeholder="New item" />
            <button class="btn primary" id="addCheck">Add</button>
            <button class="btn" id="clearChecked">Clear all</button>
          </div>
          <ul id="checklist" class="list"></ul>
        </div>

        <!-- Shared (multi-note) -->
        <div class="tabPanel" id="tab-shared" style="display:none">
          <div class="actions">
            <input id="noteTitle" placeholder="Title (e.g., Kyoto food spots)" />
            <input id="noteTag" placeholder="Tag (optional)" />
          </div>
          <textarea id="noteBody" class="bigarea" placeholder="Write your note..."></textarea>
          <div class="foot">
            <button class="btn primary" id="addNoteBtn">Add note</button>
            <button class="btn ok" id="saveNoteBtn" style="display:none">Save</button>
            <button class="btn" id="cancelNoteBtn" style="display:none">Cancel</button>
          </div>
          <div id="notesList" class="notes-grid"></div>
        </div>

        <!-- Itinerary -->
        <div class="tabPanel" id="tab-itinerary" style="display:none">
          <div class="actions it-actions">
            <input type="date" id="itDate" />
            <input type="time" id="itTime" placeholder="Time" />
            <select id="itType">
              <option value="city">City</option>
              <option value="poi">POI</option>
              <option value="note">Note</option>
            </select>
            <select id="itCity"></select>
            <input type="text" id="itTitle" placeholder="Title (for POI/Note)" />
            <input type="number" step="any" id="itLat" placeholder="Lat (POI optional)" />
            <input type="number" step="any" id="itLon" placeholder="Lon (POI optional)" />
            <button id="addItinerary" class="btn ok">Add</button>
          </div>
          <div class="hint">Tip: Click a date header to focus the map. Drag items to reorder within that day.</div>
          <div id="itineraryList"></div>
        </div>

        <!-- Recommended -->
        <div class="tabPanel" id="tab-recommended" style="display:none">
          <div class="actions">
            <select id="recCityFilter"><option value="">All cities</option></select>
            <select id="recCategoryFilter">
              <option value="">All categories</option>
              <option value="Destination">Destination</option>
              <option value="Food">Food</option>
              <option value="Culture">Culture</option>
              <option value="Shopping">Shopping</option>
            </select>
          </div>
          <div id="recommendedList" class="notes-grid"></div>
        </div>

      </div>
    </main>
  </div>

  <script src="main.js"></script>
</body>
</html>
